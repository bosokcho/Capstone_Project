# Project Checkpoint 5

**NAMES:**  Madeline Abbott, Aidan Teppema, Daisy Cho

\
\
\
\


```{r include=FALSE}
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(zoo)
library(lubridate)
library(ggmap)
library(reshape2)
library(MASS)
library(viridis)
library(shiny)
library(rjags)
library(naivebayes)
```

# Progress Made:




# Group Member Roles:

* Madeline--
* Daisy--
* Aidan--


# Research questions:

### 1.

Can we predict the location of future hurricanes based on past locations?

* prior, likelihood, posterior (new location)
Bivariate normal model

### 2.

Can we model the change in frequency of hurricanes based on trends in hurricane windspeed and category, temperature, CO2, and NAO index?

prior: $\lambda_i \sim Pois(\lambda_i)$ ($\lambda_i$ is number of hurricanes in each year $i$)

$\lambda_i \sim exp(T*t + C*t + N*t)$ (T is temperature, C is CO2 concentration, and N is NAO index)

hyperpriors:

$T \sim N(0.3, 1)$

$C \sim N(368, 1/100)$

$N \sim N(0.016, 1/0.01)$


### 3. 

Can we model the durations of hurricanes over the years?

Model 1:

Prior: $X\sim Norm(\mu,\tau)$

Hyperpriors:
$\mu\sim (0, 1000)$

$\tau \sim (2, 0.05)$

Model 2:

Prior: $X\sim Unif(0, length(x))$

Given length(x)= number of years


# Building simple models

## 1.

Can we predict the location of future hurricanes based on past locations?


* Poisson distribution, predict based off of past latitude and longitude coordinates

## 3.

```{r}
hurricane_data <- read_csv("Historical_Tropical_Storm_Tracks.csv")
hurricane_data<-na.omit(hurricane_data)
hurricane_data<-subset(hurricane_data, select=-c(BTID, AD_TIME))
hurricanes_recent <- hurricane_data %>%
  filter(YEAR > 1949)
hurricanes_recent<-hurricanes_recent[!(hurricanes_recent$NAME=="NOTNAMED"),]

# Hurricane data only looking at Date and name
hurricane_time<-subset(hurricanes_recent, select = c(NAME,YEAR,MONTH,DAY))
#Group data by year and name and subtracting starting time from end time for each hurricane (duration)
foo <- hurricane_time %>%
  group_by(YEAR, NAME) %>%
  mutate(date = as.Date(paste(YEAR, MONTH, DAY, sep='-')), "%Y-%m-%d") %>%
  summarise(duration = max(date) - min(date))
#removed outlier
foo<-foo[!(foo$YEAR==1954 & foo$NAME=="ALICE"),]
# Averaging duration per year
foo<-group_by(foo, YEAR)%>%
  summarise(mean(duration))
colnames(foo)[2] <- "Average_Duration"
ggplot(foo, aes(x=Average_Duration))+
  geom_histogram(boundary=0,color="white", aes(y=..density..))
ggplot(foo,aes(x=YEAR, y=Average_Duration))+
  geom_line()
summary(foo)

```

```{r}
library(rjags)

#specify the model
duration_model <- "model{
    #Data
    for(i in 1:length(x)) {
        x[i] ~ dnorm(mu,tau)
    }

    #Priors
    mu ~ dnorm(0,1/1000) 
    tau ~ dgamma(2, 0.05)
}"



duration_jags <- jags.model(textConnection(duration_model), data=list(x=foo$Average_Duration), inits=list(.RNG.name="base::Wichmann-Hill", .RNG.seed=1989))



duration_sim <- coda.samples(duration_jags, variable.names=c("mu","tau", "theta"), n.iter=10000)


   
duration_samples <- data.frame(step=1:10000, duration_sim[[1]])
head(duration_samples)
```

```{r}
#specify the model
duration2_model <- "model{
    #Data
    for(i in 1:length(x)) {
        x[i] ~ dnorm(mu,tau)
    }

    #Priors
    mu ~ dnorm(6.37,1/10) 
    tau ~ dgamma(9, 6)
}"



duration2_jags <- jags.model(textConnection(duration2_model), data=list(x=foo$Average_Duration), inits=list(.RNG.name="base::Wichmann-Hill", .RNG.seed=1989))



duration2_sim <- coda.samples(duration2_jags, variable.names=c("mu","tau"), n.iter=10000)


   
duration2_samples <- data.frame(step=1:10000, duration2_sim[[1]])
head(duration2_samples)
```
